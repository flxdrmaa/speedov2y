<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RAGEMP Speedometer</title>
    <style>
        * {
            user-select: none;
            user-drag: none;
            box-sizing: border-box;
        }
        body {
            background-color: transparent !important;
            font-family: 'Arial', sans-serif;
            overflow: hidden;
            margin: 0;
        }

        .widget-wrapper {
            position: fixed;
            bottom: 15px;
            right: 15px;
            width: 320px;
            height: 320px;
        }

        .speedometer, .side-gauges, .rpm-bars {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        /* Speedometer */
        .speedometer {
            background: radial-gradient(circle, #1e3a5f 0%, #0a1929 100%);
            border-radius: 50%;
            box-shadow: 0 10px 40px rgba(0,0,0,0.7), inset 0 0 40px rgba(0,0,0,0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 1;
        }

        /* GEAR BULATAN BIRU - SANGAT KECIL & DI ATAS KMH */
        .gear-container {
            position: absolute;
            top: 70px; /* NAIK LEBIH ATAS */
            left: 50%;
            transform: translateX(-50%);
            z-index: 2;
        }
        .gear-circle {
            width: 32px;    /* SANGAT KECIL */
            height: 32px;   /* SANGAT KECIL */
            background: radial-gradient(circle, #3b82f6 0%, #1d4ed8 80%);
            border-radius: 50%;
            box-shadow: 
                0 0 10px rgba(59, 130, 246, 0.7),
                inset 0 1px 4px rgba(255,255,255,0.2),
                0 1px 6px rgba(0,0,0,0.4);
            display: flex;
            align-items: center;
            justify-content: center;
            border: 1.5px solid rgba(255,255,255,0.3);
        }
        #gearValue {
            font-size: 16px;   /* SANGAT KECIL */
            font-weight: bold;
            color: #ffffff;
            text-shadow: 0 0 5px rgba(255,255,255,0.7);
            line-height: 1;
        }

        /* 10 BAR RPM â†’ HANYA PUTIH */
        .rpm-bars {
            z-index: 4;
            overflow: visible;
        }
        .rpm-bar {
            fill: none;
            stroke-width: 14;
            stroke-linecap: round;
            stroke: transparent;
            transition: stroke 0.3s ease, filter 0.3s ease;
        }
        .rpm-bar.active {
            stroke: #ffffff;
            filter: drop-shadow(0 0 12px #ffffff);
        }

        /* Scale */
        .scale-marks { position: absolute; width: 100%; height: 100%; }
        .scale-mark {
            position: absolute; width: 2px; height: 12px; background: #475569;
            left: 50%; top: 15px; transform-origin: 50% 145px;
        }
        .scale-mark.major { height: 18px; width: 3px; background: #64748b; }
        .scale-number {
            position: absolute; color: #94a3b8; font-size: 14px;
            font-weight: 600; transform: translate(-50%, -50%);
        }

        .speed-display { 
            text-align: center; 
            position: relative; 
            z-index: 2;
            margin-top: 16px; /* Jarak dari gear ke KMH */
        }
        .speed-value {
            font-size: 80px; 
            font-weight: bold; 
            color: white;
            text-shadow: 0 0 20px rgba(255,255,255,0.5);
            line-height: 1; 
            margin-bottom: 5px;
        }
        .speed-unit { 
            font-size: 16px; 
            color: #94a3b8; 
            letter-spacing: 2px; 
            font-weight: 600; 
        }
        
        .odometer {
            position: absolute; 
            bottom: 70px; 
            background: rgba(0,0,0,0.4);
            padding: 6px 14px; 
            border-radius: 20px; 
            font-size: 13px; 
            color: #94a3b8;
        }

        /* Fuel & Health */
        .side-gauges { z-index: 3; }
        .arc-gauge {
            position: absolute; width: 320px; height: 320px; top: 0; left: -35px;
        }
        #engineGauge { left: auto; right: -35px; }
        .arc-gauge path { fill: none; stroke-width: 16; stroke-linecap: round; }
        .arc-gauge .arc-track { stroke: #374151; }
        .arc-gauge .arc-progress { transition: stroke-dashoffset 0.3s ease-out, stroke 0.3s ease; }
        .arc-progress.white { stroke: #e2e8f0; }
        .arc-progress.yellow { stroke: #fbbf24; }
        .arc-progress.red { stroke: #ef4444; animation: warning-pulse 1s ease-in-out infinite; }
        @keyframes warning-pulse { 0%,100%{opacity:1} 50%{opacity:0.4} }

        .top-icons {
            position: absolute; top: 15px; width: 100%; display: flex;
            justify-content: space-between; padding: 0 20px; font-size: 28px;
        }
        .bottom-icons {
            position: absolute; bottom: 95px; display: flex; gap: 12px; font-size: 20px;
        }
        .indicator-icon {
            opacity: 0.2; transition: opacity 0.3s, color 0.3s;
            filter: drop-shadow(0 1px 2px rgba(0,0,0,0.5));
        }
        .top-icons .indicator-icon { opacity: 1; }
        .indicator-icon.on { opacity: 1; }
        .engine-status-icon.on { color: #34d399; }
        .seatbelt-icon.on { opacity: 0.2; }
        .seatbelt-icon.off { color: #ef4444; opacity: 1; }
        .headlights-icon.on { color: #fde047; }
        .headlights-icon.high-beam { color: #fde047; text-shadow: 0 0 15px #fde047; }
        .left-indicator, .right-indicator { color: #f59e0b; }
        @keyframes blink { 50% { opacity: 1; } }
        .blinking { animation: blink 1s step-end infinite; }
    </style>
</head>
<body>
    <div class="widget-wrapper">

        <!-- Speedometer -->
        <div class="speedometer">
            <div class="scale-marks" id="scaleMarks"></div>
            
            <!-- GEAR BULATAN BIRU KECIL & ATAS -->
            <div class="gear-container">
                <div class="gear-circle">
                    <div class="gear-display" id="gearValue">N</div>
                </div>
            </div>
            
            <div class="speed-display">
                <div class="speed-value" id="speedValue">0</div>
                <div class="speed-unit" id="speedUnit">KMH</div>
            </div>
            
            <div class="odometer" id="rpmDisplay">0.0000 RPM</div>
            
            <div class="bottom-icons">
                <div class="indicator-icon engine-status-icon" id="engineStatusIcon">Fire</div>
                <div class="indicator-icon seatbelt-icon" id="seatbeltIcon">No Entry</div>
                <div class="indicator-icon headlights-icon" id="headlightsIcon">Light Bulb</div>
                <div class="indicator-icon left-indicator" id="leftIndicator">Left Arrow</div>
                <div class="indicator-icon right-indicator" id="rightIndicator">Right Arrow</div>
            </div>
        </div>

        <!-- Fuel & Health -->
        <div class="side-gauges">
            <svg class="arc-gauge" id="fuelGauge" viewBox="0 0 320 320">
                <path class="arc-track" d="M 55,275 A 165,165 0 0 1 55,45"/>
                <path class="arc-progress white" id="fuelProgress" d="M 55,275 A 165,165 0 0 1 55,45"/>
            </svg>
            <svg class="arc-gauge" id="engineGauge" viewBox="0 0 320 320">
                <path class="arc-track" d="M 265,45 A 165,165 0 0 1 265,275"/>
                <path class="arc-progress white" id="engineProgress" d="M 265,45 A 165,165 0 0 1 265,275"/>
            </svg>
            <div class="top-icons">
                <div class="indicator-icon" id="fuelIcon">Fuel</div>
                <div class="indicator-icon" id="healthIcon">Wrench</div>
            </div>
        </div>

        <!-- 10 BAR PUTIH -->
        <svg class="rpm-bars" viewBox="0 0 320 320" id="rpmBars"></svg>

    </div>

    <script>
        let elements = {};

        function initializeUI() {
            elements = {
                speedValue: document.getElementById('speedValue'),
                rpmDisplay: document.getElementById('rpmDisplay'),
                gearValue: document.getElementById('gearValue'),
                fuelProgress: document.getElementById('fuelProgress'),
                engineProgress: document.getElementById('engineProgress'),
                rpmBars: document.getElementById('rpmBars')
            };

            elements.fuelArcLength = elements.fuelProgress.getTotalLength();
            elements.engineArcLength = elements.engineProgress.getTotalLength();
            elements.fuelProgress.style.strokeDasharray = elements.fuelArcLength;
            elements.engineProgress.style.strokeDasharray = elements.engineArcLength;

            generateRPMBars();
            generateScaleMarks();
        }

        function generateRPMBars() {
            const svg = elements.rpmBars;
            const centerX = 160, centerY = 160;
            const radius = 152;
            const startAngle = -135;
            const sweepAngle = 270;
            const segmentCount = 10;
            const anglePerSegment = sweepAngle / segmentCount;

            for (let i = 0; i < segmentCount; i++) {
                const angle1 = startAngle + i * anglePerSegment;
                const angle2 = startAngle + (i + 1) * anglePerSegment;
                const rad1 = (angle1 - 90) * Math.PI / 180;
                const rad2 = (angle2 - 90) * Math.PI / 180;

                const x1 = centerX + radius * Math.cos(rad1);
                const y1 = centerY + radius * Math.sin(rad1);
                const x2 = centerX + radius * Math.cos(rad2);
                const y2 = centerY + radius * Math.sin(rad2);

                const pathData = `M ${x1} ${y1} A ${radius} ${radius} 0 0 1 ${x2} ${y2}`;
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                path.setAttribute('d', pathData);
                path.setAttribute('class', 'rpm-bar');
                path.setAttribute('id', `rpmBar${i + 1}`);
                svg.appendChild(path);
            }
        }

        function generateScaleMarks() {
            const scaleMarks = document.getElementById('scaleMarks');
            const totalMarks = 10, startAngle = -135, sweepAngle = 270, numberRadius = 112;
            const centerX = 160, centerY = 160;

            for (let i = 0; i < totalMarks; i++) {
                const angleDeg = startAngle + (i * sweepAngle / (totalMarks - 1));
                const mark = document.createElement('div');
                mark.className = 'scale-mark major';
                mark.style.transform = `translateX(-50%) rotate(${angleDeg}deg)`;
                scaleMarks.appendChild(mark);

                const number = document.createElement('div');
                number.className = 'scale-number';
                number.textContent = i + 1;
                const angleRad = (angleDeg - 90) * Math.PI / 180;
                const x = centerX + numberRadius * Math.cos(angleRad);
                const y = centerY + numberRadius * Math.sin(angleRad);
                number.style.left = `${x}px`;
                number.style.top = `${y}px`;
                scaleMarks.appendChild(number);
            }
        }

        function setRPM(rpm) {
            elements.rpmDisplay.innerText = `${rpm.toFixed(4)} RPM`;
            const activeSegments = Math.floor(rpm * 10);
            for (let i = 1; i <= 10; i++) {
                const bar = document.getElementById(`rpmBar${i}`);
                bar.classList.toggle('active', i <= activeSegments);
            }
        }

        function setSpeed(speed) {
            elements.speedValue.innerText = Math.round(speed * 3.6);
        }

        function setFuel(fuel) {
            const p = fuel * 100;
            const offset = elements.fuelArcLength * (1 - p / 100);
            elements.fuelProgress.style.strokeDashoffset = offset;
            elements.fuelProgress.className = p < 20 ? 'arc-progress red' : p < 50 ? 'arc-progress yellow' : 'arc-progress white';
        }

        function setHealth(health) {
            const p = health * 100;
            const offset = elements.engineArcLength * (1 - p / 100);
            elements.engineProgress.style.strokeDashoffset = offset;
            elements.engineProgress.className = p < 20 ? 'arc-progress red' : p < 50 ? 'arc-progress yellow' : 'arc-progress white';
        }

        function setGear(gear) {
            elements.gearValue.innerText = gear === 0 ? 'N' : gear;
        }

        document.addEventListener('DOMContentLoaded', initializeUI);

        // TESTING
        let testRPM = 0, testGear = 0;
        setInterval(() => {
            testRPM = (testRPM + 0.01) % 1.1;
            setRPM(testRPM > 1 ? 1 : testRPM);
            testGear = (testGear + 1) % 7;
            setGear(testGear);
        }, 800);
    </script>
</body>
</html>
